server:
  port: 8080

spring:
  application:
    name: webhook-service

webhook:
  retry:
    max-attempts: 5
    initial-delay-ms: 1000
    multiplier: 2.0

  # Dynamic schema â†’ payload class + ordered handler chain
  schemas:
    "[com.example.webhook.model.payload.PurchaseCreatedPayload]":
#      className: com.example.webhook.model.payload.PurchaseCreatedPayload
      handlers:
        - fetchPdfHandler        # PurchaseCreatedPayload -> byte[]
        - storeNs3Handler        # byte[] -> String (ns3 uri)
        - callModuleCHandler     # String (ns3 uri) -> String (status)
      retry:
        enabled: true
        strategy: backoff        # fixed | backoff | jitter
        retry-on:
          - java.io.IOException
          - org.springframework.web.reactive.function.client.WebClientRequestException

security:
  webhook:
    expected-token: "my-secure-token"
    required-headers:
      - "X-Auth-Token"
      - "X-Request-Id"

logging:
  level:
    root: INFO
    com.example.webhook: DEBUG
